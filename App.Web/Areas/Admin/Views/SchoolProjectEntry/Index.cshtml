@model ICollection<global::Models.SchoolProjectEntry>

@{
    ViewBag.Title = "Index";
    Layout = "~/Areas/Admin/Views/Shared/_LayoutPage.cshtml";
}
@if(Model != null && Model.Count > 0){
<div class="row">
    <section class="col-xs-12 col-sm-12 col-md-12 col-lg-12"> 
        <div class="panel panel-default">
            <div class="panel-heading">
                List of available Entries
            </div>
            <div class="panel-body">
                <table style="width:100%" id="entries" class="table table-striped">
                    <thead>
                        <tr>
                            <th>Title</th>
                            <th>Description</th>
                            <th>Creationdate</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var entry in Model)
                        {
                            <tr data-id="entry-@entry.Id">
                               <td>@Html.ActionLink(@entry.Title, "Edit", new { id= entry.Id })</td>
                               <td>@entry.Description</td>
                               <td>@entry.CreatedDate</td>
                               <td>
                                    @Html.ActionLink("Edit", "Edit", new { id= entry.Id }) |
                                    @Html.ActionLink("Publish", "Publish", new { id = entry.Id })
                                    @Html.ActionLink("Delete", "Delete", new { id = entry.Id}, new {@class="delete-link"})
                               </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>  
    </section>
</div>
}
else{
<div class="row">
    <section class="col-xs-12 col-sm-12 col-md-12 col-lg-12"> 
        <div class="panel panel-default">
            <div class="panel-heading">
                List of available Entries for schoolprojects
            </div>
            <div class="panel-body">
                No available entries for schoolprojects!
            </div>
        </div>  
    </section>
</div>   
}
<div id="delete-dialog" title="Confirmation">
    <p>Are you sure you want to delete this Article?</p>
</div>
    
@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    @Scripts.Render("~/scripts/admin/schoolprojectentry.js")
    <script>
        var deleteLinkObj;   
        (function () {
            $('.delete-link').click(function () {
                deleteLinkObj = $(this);  //for future use
                $('#delete-dialog').dialog('open');
                return false; // prevents the default behaviour
            });
            $('#delete-dialog').dialog({
                autoOpen: false, width: 400, resizable: false, modal: true, //Dialog options
                buttons: {
                    "Delete": function () {
                        $.post(deleteLinkObj[0].href, function (data) {  //Post to action

                            if (data.state == true) {
                                var dataRow = $('#entries tr[data-id="entry-' + data.id + '"]');
                                $(dataRow).effect('highlight', {}, 500, function () {
                                    $(this).fadeOut('fast', function () {
                                        $(this).remove();
                                    });
                                });
                            }
                            else {
                                //(optional) Display Error
                            }
                        });
                        $(this).dialog("close");
                    },
                    "Cancel": function () {
                        $(this).dialog("close");
                    }
                }
            });
        })();
    </script>
}